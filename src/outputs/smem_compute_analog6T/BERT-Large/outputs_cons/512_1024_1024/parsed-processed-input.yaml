dumped_by_timeloop_front_end: true
architecture:
    version: '0.4'
    subtree:
      - name: system_top_level
        attributes:
            version: '0.4'
            cimtype: "analog6T"
            Cp: 4
            Rp: 64
            Ch: 16
            Rh: 1
            X: 1
            Y: 4
            technology: "45nm"
            global_cycle_seconds: 1e-9
            has_power_gating: false
            power_gated_at: null
        local:
          - name: DRAM[1..1]
            class: DRAM
            attributes:
                type: "LPDDR4"
                width: 64
                metadata_storage_width: 64
                datawidth: 8
                cluster_size: 1
                read_bandwidth: 32
                write_bandwidth: 32
                has_power_gating: false
                n_banks: 2
                reduction_supported: true
                multiple_buffering: 1
                min_utilization: 0
                allow_overbooking: false
                meshX: 1
                meshY: 1
                technology: "45nm"
                global_cycle_seconds: 1e-9
                power_gated_at: null
            required_actions:
              - leak
              - read
              - write
              - update
            enabled: true
          - name: inter_CiMBank_spatial[1..1]
            class: dummy_storage
            attributes:
                width: 1
                depth: 1
                datawidth: 1
                technology: -1
                has_power_gating: false
                n_banks: 2
                cluster_size: 1
                reduction_supported: true
                multiple_buffering: 1
                min_utilization: 0
                allow_overbooking: false
                meshX: 1
                meshY: 1
                global_cycle_seconds: 1e-9
                power_gated_at: null
            enabled: true
          - name: inter_CiMArray_spatial[1..4]
            class: dummy_storage
            attributes:
                width: 1
                depth: 1
                datawidth: 1
                technology: -1
                has_power_gating: false
                n_banks: 2
                cluster_size: 1
                reduction_supported: true
                multiple_buffering: 1
                min_utilization: 0
                allow_overbooking: false
                meshX: 1
                meshY: 4
                global_cycle_seconds: 1e-9
                power_gated_at: null
            enabled: true
          - name: CiMInpBuffer[1..1024]
            class: storage
            subclass: custom_storage
            attributes:
                datawidth: 8
                width: 8
                depth: 1
                type: "zero"
                has_power_gating: false
                n_banks: 2
                cluster_size: 1
                reduction_supported: true
                multiple_buffering: 1
                min_utilization: 0
                allow_overbooking: false
                meshX: 4
                meshY: 256
                technology: "45nm"
                global_cycle_seconds: 1e-9
                power_gated_at: null
            required_actions:
              - leak
              - read
              - write
              - update
            enabled: true
          - name: CiMOutBuffer[1..1024]
            class: storage
            subclass: custom_storage
            attributes:
                datawidth: 8
                width: 8
                depth: 16
                type: "zero"
                has_power_gating: false
                n_banks: 2
                cluster_size: 1
                reduction_supported: true
                multiple_buffering: 1
                min_utilization: 0
                allow_overbooking: false
                meshX: 4
                meshY: 256
                technology: "45nm"
                global_cycle_seconds: 1e-9
                power_gated_at: null
            required_actions:
              - leak
              - read
              - write
              - update
            enabled: true
          - name: CiMStorage[1..1024]
            class: storage
            subclass: custom_storage
            attributes:
                datawidth: 8
                width: 128
                depth: 1
                type: "analog6T"
                has_power_gating: false
                n_banks: 2
                cluster_size: 1
                reduction_supported: true
                multiple_buffering: 1
                min_utilization: 0
                allow_overbooking: false
                meshX: 4
                meshY: 256
                technology: "45nm"
                global_cycle_seconds: 1e-9
                power_gated_at: null
            required_actions:
              - leak
              - read
              - write
              - update
            enabled: true
          - name: CiMUnit[1..1024]
            class: compute
            subclass: cimmac_unit
            attributes:
                type: "analog6T"
                datawidth: 8
                has_power_gating: false
                meshX: 4
                meshY: 256
                technology: "45nm"
                global_cycle_seconds: 1e-9
                power_gated_at: null
            required_actions:
              - compute
            enabled: true
architecture_constraints:
    targets:
      - target: DRAM
        type: temporal
        factors: M=512,N=16,K=4
        permutation: MKN
      - target: DRAM
        type: bypass
        keep:
          - A
          - B
          - Z
      - type: spatial
        target: inter_CiMBank_spatial
        factors: M=1,N=1,K=4
        permutation: NKM
        split: 1
      - factors: M=1,N=1,K=1
        permutation: MNK
        type: temporal
        target: inter_CiMBank_spatial
      - bypass:
          - A
          - B
          - Z
        type: bypass
        target: inter_CiMBank_spatial
      - type: spatial
        target: inter_CiMArray_spatial
        factors: M=1,N=4,K=64
        permutation: NKM
        split: 1
      - factors: M=1,N=1,K=1
        permutation: MNK
        type: temporal
        target: inter_CiMArray_spatial
      - bypass:
          - A
          - B
          - Z
        type: bypass
        target: inter_CiMArray_spatial
      - target: CiMInpBuffer
        type: temporal
        permutation: MNK
        factors: M=1,N=1,K=1
      - target: CiMInpBuffer
        type: bypass
        keep:
          - A
        bypass:
          - B
          - Z
      - target: CiMOutBuffer
        type: temporal
        permutation: MNK
        factors: M=1,N=1,K=1
      - target: CiMOutBuffer
        type: bypass
        keep:
          - Z
        bypass:
          - B
          - A
      - target: CiMStorage
        type: temporal
        permutation: MKN
        factors: M=1,N=16,K=1
      - target: CiMStorage
        type: bypass
        keep:
          - B
        bypass:
          - A
          - Z
problem:
    version: '0.4'
    instance:
        K: 1024
        M: 512
        N: 1024
        densities:
            A:
                density: 0.5
                distribution: fixed_structured
                band_width: 0
                workload_tensor_size: 0
    shape:
        name: gemm_ABZ
        dimensions:
          - M
          - N
          - K
        data_spaces:
          - name: A
            projection:
              -   -   - M
              -   -   - K
            read_write: false
          - name: B
            projection:
              -   -   - N
              -   -   - K
            read_write: false
          - name: Z
            projection:
              -   -   - M
              -   -   - N
            read_write: true
        coefficients: []
compound_components:
    version: '0.4'
    classes:
      - name: intmac
        attributes:
            technology: "must_specify"
            multiplier_width: "must_specify"
            adder_width: "must_specify"
            global_cycle_seconds: "must_specify"
        subcomponents:
          - name: intadder
            class: aladdin_adder
            attributes:
                width: adder_width
          - name: intmultiplier
            class: aladdin_adder
            attributes:
                width_a: multiplier_width
                width_b: multiplier_width
        actions:
          - name: compute
            subcomponents:
              - name: intadder
                actions:
                  - name: read
              - name: intmultiplier
                actions:
                  - name: read
          - name: leak
            subcomponents:
              - name: intadder
                actions:
                  - name: leak
              - name: intmultiplier
                actions:
                  - name: leak
      - name: smartbuffer_metadata
        attributes:
            technology: "must_specify"
            width: "must_specify"
            depth: "must_specify"
            metadata_storage_width: "must_specify"
            metadata_storage_depth: "must_specify"
            n_rdwr_ports: 1
            metadata_counter_width: 0
        subcomponents:
          - name: storage
            class: smartbuffer_SRAM
            attributes:
                technology: technology
                width: width
                depth: depth
                n_rdwr_ports: n_rdwr_ports
          - name: metadata_storage
            class: smartbuffer_SRAM
            attributes:
                technology: technology
                width: metadata_storage_width
                depth: metadata_storage_depth
                n_rdwr_ports: n_rdwr_ports
          - name: metadata_counters[0..1]
            class: intadder
            attributes:
                technology: technology
                datawidth: metadata_counter_width
        actions:
          - name: read
            subcomponents:
              - name: storage
                actions:
                  - name: read
          - name: write
            subcomponents:
              - name: storage
                actions:
                  - name: write
          - name: update
            subcomponents:
              - name: storage
                actions:
                  - name: write
          - name: metadata_read
            subcomponents:
              - name: metadata_storage
                actions:
                  - name: read
          - name: metadata_write
            subcomponents:
              - name: metadata_storage
                actions:
                  - name: write
          - name: metadata_update
            subcomponents:
              - name: metadata_storage
                actions:
                  - name: write
          - name: leak
            subcomponents:
              - name: storage
                actions:
                  - name: leak
                    arguments:
                        global_cycle_seconds: global_cycle_seconds
              - name: metadata_storage
                actions:
                  - name: leak
                    arguments:
                        global_cycle_seconds: global_cycle_seconds
          - name: decompression_count
            subcomponents:
              - name: metadata_counters[1]
                actions:
                  - name: add
          - name: compression_count
            subcomponents:
              - name: metadata_counters[0]
                actions:
                  - name: add
      - name: smartbuffer_RF
        attributes:
            technology: "must_specify"
            width: "must_specify"
            depth: "must_specify"
            memory_width: max(32, width)
            memory_depth: max(64, depth)
            widthscale: width / memory_width
            depthscale: depth / memory_depth
            real_depth: depth
            area_scale: widthscale * depthscale
            dynamic_energy_scale: widthscale * (depthscale ** (1.56 / 2))
            static_energy_scale: area_scale
            n_rdwr_ports: 1
            global_cycle_seconds: "must_specify"
        subcomponents:
          - name: storage
            class: regfile
            area_scale: area_scale
            attributes:
                width: memory_width
                depth: memory_depth
                n_rdwr_ports: n_rdwr_ports
                global_cycle_seconds: global_cycle_seconds
          - name: address_generators[0..1]
            class: intadder
            attributes:
                n_bits: max(1, ceil(log2(real_depth))) if real_depth >= 1 else 1
                precision: max(1, ceil(log2(real_depth))) if real_depth >= 1 else
                    1
                datawidth: max(1, ceil(log2(real_depth))) if real_depth >= 1 else
                    1
                global_cycle_seconds: global_cycle_seconds
        actions:
          - name: write
            subcomponents:
              - name: storage
                actions:
                  - name: write
                    energy_scale: dynamic_energy_scale
              - name: address_generators[0]
                actions:
                  - name: add
          - name: read
            subcomponents:
              - name: storage
                actions:
                  - name: read
                    energy_scale: dynamic_energy_scale
              - name: address_generators[1]
                actions:
                  - name: add
          - name: leak
            subcomponents:
              - name: storage
                actions:
                  - name: leak
                    energy_scale: static_energy_scale
              - name: address_generators[0..1]
                actions:
                  - name: leak
          - name: update
            subcomponents:
              - name: storage
                actions:
                  - name: write
                    energy_scale: dynamic_energy_scale
              - name: address_generators[0]
                actions:
                  - name: add
      - name: smartbuffer_SRAM
        attributes:
            technology: "must_specify"
            width: "must_specify"
            depth: "must_specify"
            n_rw_ports: 1
            global_cycle_seconds: "must_specify"
        subcomponents:
          - name: storage
            class: SRAM
            attributes:
                width: width
                depth: depth
                n_rw_ports: n_rw_ports
                technology: technology
                global_cycle_seconds: global_cycle_seconds
          - name: address_generators[0..1]
            class: intadder
            attributes:
                n_bits: max(1, ceil(log2(depth))) if depth >= 1 else 1
                precision: max(1, ceil(log2(depth))) if depth >= 1 else 1
                datawidth: max(1, ceil(log2(depth))) if depth >= 1 else 1
                global_cycle_seconds: global_cycle_seconds
        actions:
          - name: write
            subcomponents:
              - name: storage
                actions:
                  - name: write
              - name: address_generators[0]
                actions:
                  - name: add
          - name: read
            subcomponents:
              - name: storage
                actions:
                  - name: read
              - name: address_generators[1]
                actions:
                  - name: add
          - name: leak
            subcomponents:
              - name: storage
                actions:
                  - name: leak
              - name: address_generators[0..1]
                actions:
                  - name: leak
          - name: update
            subcomponents:
              - name: storage
                actions:
                  - name: write
              - name: address_generators[0]
                actions:
                  - name: add
      - name: cimmac_unit
        attributes:
            technology: "must_specify"
            datawidth: "must_specify"
            type: "must_specify"
        subcomponents:
          - name: arithmetic
            class: cimmac
            attributes:
                datawidth: datawidth
                technology: technology
                type: type
        actions:
          - name: compute
            subcomponents:
              - name: arithmetic
                actions:
                  - name: mac
      - name: custom_storage
        attributes:
            technology: "must_specify"
            type: "must_specify"
            datawidth: "must_specify"
            depth: "must_specify"
            width: "must_specify"
        subcomponents:
          - name: custom_memory
            class: cimstorage
            attributes:
                technology: technology
                datawidth: datawidth
                type: type
        actions:
          - name: read
            subcomponents:
              - name: custom_memory
                actions:
                  - name: read
          - name: write
            subcomponents:
              - name: custom_memory
                actions:
                  - name: write
          - name: update
            subcomponents:
              - name: custom_memory
                actions:
                  - name: update
          - name: leak
            subcomponents:
              - name: custom_memory
                actions:
                  - name: leak
mapping: []
mapper:
    optimization_metrics:
      - edp
    version: '0.4'
    live_status: false
    timeout: 100000
    victory_condition: 100
    algorithm: random
    diagnostics: true
    out_prefix: timeloop-mapper
    num_threads: 8
    optimization_metric: []
    search_size: null
    sync_interval: null
    log_interval: 1
    log_oaves: false
    log_oaves_mappings: false
    log_stats: false
    log_suboptimal: false
    penalize_consecutive_bypass_fails: false
    emit_whoop_nest: false
    max_temporal_loops_in_a_mapping: -1
    filter_revisits: false
    max_permutations_per_if_visit: 16
mapspace:
    version: '0.4'
    template: ruby
globals:
    version: '0.4'
    environment_variables: {}
    expression_custom_functions: []
    accelergy_plug_ins: []
